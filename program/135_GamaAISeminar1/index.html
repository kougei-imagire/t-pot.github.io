<head>
	<title>t-pot『世界表現』</title>
	<link rel="stylesheet" type="text/css" href="../if.css">
</head>
<meta http-equiv=Content-Type content="text/html; charset=shift_jis">
<body>


<div class="contents">
<center>
<BR CLEAR=ALL>
<BR CLEAR=ALL>
<h1>世界表現</h1><br>
<h3>〜 「ゲームAI連続セミナー第1回」レポート 〜</h3>
<BR CLEAR=ALL>
<BR CLEAR=ALL>
<BR CLEAR=ALL>
<!--<image src = "title.png">-->
<br>
<hr>
</center>
<div>


<h2>■はじめに</h2>


<p>
<a href="http://www6.plala.or.jp/mnagaku/">長久さん</a>や三宅さんがやっている<a href="http://www.igda.jp/modules/eguide/event.php?eid=36">「ゲームAI連続セミナー」</a> に行ってみました。後半の方です。<br>
今回のテーマは、知識表現、世界表現です。
</p>

<p>
基本的にセミナー中にメモったものを起こし直したので、
聞き漏らしたり、勘違いしているところがあると思います。すいません。
</p>

<hr>

<h2>■ゲームAIセミナーについて</h2>

<p>
ゲームAIはコンテンツに依存しており、
ゲームの方向性に応じて、必要な技術は変化し、その蓄積によってノウハウが貯められている。<br>
AIの技術がデザインを発展させたり、その逆の可能性もあると考えられる。<br>
日本は、討論する場がないので、差が開いていた。<br>
このセミナーでは、いろいろなゲームの実例を用いてAIの紹介を行う。
</p>
<p>
Q.本セミナーで取り扱うラインナップがFPSに偏っているのは？<br>
A.公開されているのはFPSが多いから。
</p>

<hr>

<h2>■知識表現とは</h2>

<p>
AIの中で一番重要なのは、周囲をどのように認識させるかということになる。<br>
AIに周囲の状況をすべて考えさせるのは大変。<br>
人間がヒントを与えるのが手間がかかるが確実な方法。
</p>
<p>
知識表現とは、AIのためのデータを準備してあげること。<br>
すでにいろいろな研究がされている（依存グラフ、意味ネットワーク、etc.）。<br>
今回は、グローバルな世界の表現を行う「世界表現」の説明をする。<br>
たとえば、道検索のためのポイントデータ（ウェイポイントデータ）を与える。<br>
世界表現を精密にするほど、AIができることが増え、できることが高度化する。
</p>


<hr>

<h2>■Killzoneについて</h2>

<p>
FPS(<a href="http://www.killzoneps2.com/">公式サイト</a>)。<br>
13人までAIが可能。マップが多彩で広い。相手も人間（モンスターとかではない）。<br>
構造物は、ほとんど壊れない。<br>
</p>
<p>
AIの目的は複雑で広い中を有利な場所を見つけて戦うこと。<br>
よくあるのは、デザイナーが良い場所をデータとして仕込んだり、スクリプトによる条件反射による処理が行われる。<br>
Killzoneは状況に応じて最適な位置を計算する。<br>
高さや視界の広さをデータに用意して有利な場所を探す。<br>
重み付けして一番良い点を検索したりする。<br>
また、戦況に応じて最適な位置の検索を行ったりもする。<br>
静的なもの(2001にやった)と、動的なもの(2005)があり、きちんと両立されているところが良い点。<br>
</p>
<p>
Q&A<br>
Q.実はここは変な設定で見晴らしが良いんだとか、特殊なデータを埋め込むとかはやらない？<br>
A.やってない。一般的に行っているのが良い点<br>
</p>

<hr>

<h2>■静的な世界表現</h2>
<p>
目的地が決まっていて、そこに行くには？<br>
　ウェイポイントを敷き詰めて<br>
　　等間隔<br>
　地形情報を蓄積する<br>
　　局所的、グループ的、他のポイントとの関係、フォーカス（偏り）<br>
　各ポイントの基本情報から抽象的な情報を抽出する<br>
　　抽象的な情報をレベルデザイナーが考える<br>
　　そこから必要な情報を考えて、評価関数で評価する。<br>
　　たとえば、敵から隠れているかどうかは周辺のウェイポイントとの間で視線が届くかで考える。<br>
　総合的に情報を計算する。<br>
　　すべての評価ポイントを足しこんで、一番良い場所を見つける<br>
コンピュータでやらせるための手順が大変だが、一度作れば状況が変わったものをすぐ計算してくれる。<br>
計算量が多いので、ゲームには使えないが、軽くしたのがKillzone
</p>
<p>
Q&A<br>
Q.データの数が多くない？自動で作れない？<br>
A.明るさや視界などは計算で求められる。あげられているものは、人間が設定するものはない。今までのものは、前計算できるものだからリアルタイムに計算するのは大変なので、やりましたということ。動的になると、人間が手で埋めるのではできないことができるようになる。<br>
Q.抽象的な情報はどのように考える？レベルデザイナーが経験で？<br>
A.デザイナーや企画から。正解があるものではない。
</p>


<hr>

<h2>■動的な世界表現</h2>

<p>
敵や味方が動く場合を取り扱う。<br>
情報を抽出する部分が動的に変わる処理に変更される。<br>
ウェイポイントは、グリッドではなく接続情報を持ったメッシュ<br>
各ポイントに関して、８方向でどこまで見えるかデータを持つ。<br>
射線判定に使う。<br>
　お互いに方向が見えていれば射線がつながる。<br>
　前もって、どこまで見えるかデータを持っているので、高速に計算できる。<br>
　キャラクタは常に動いているので、このような大雑把な計算でもOK<br>
　逆に瞬間瞬間で情報が鋭く変わるものが良いとは限らない。<br>
　具体例：敵を撃てる範囲に移動<br>
　　移動する適当な候補点を近くの点として絞り込む。<br>
　　攻撃したい敵の射線を計算して、各候補点に関して撃ちやすいか計算する。<br>
　　他の敵から撃たれにくいか計算する。<br>
　　さらに、一定距離を保つなどの最適なポイントを計算して、これを評価<br>
　　最終的に評価値を足して移動ポイントを計算。<br>
　具体例；手榴弾を投げるポイントの計算<br>
　　　敵が移動できる位置、爆発の届く範囲、投げられる範囲、から評価を行う。<br>
以上を用いて、広大なマップに対応したAIを実現した。
</p>
<p>
Q&A<br>
Q.毎フレーム計算してる？<br>
A.行動単位時間があって、5〜10秒単位で計算する。ゲームデザイナーが判断。<br>
Q.広大になると、ポイントの情報が多くなると思うんだけど<br>
A.マップが静的なので、事前計算が大変になるだけ<br>
Q.メモリが多くならない？<br>
A.方向に関する距離だけもって、ポイント相互のデータを持っていないので、ポイント数にリニアに消費するだけ<br>
Q.どうやってポイントを決めてる？<br>
A.障害物を避けて２ｍおきにランダム。デザイナーが調整している可能性あり。<br>
Q.高さのあるマップに対応できる？<br>
A.高さ情報込みでテーブル化しているので、OK<br>
Q.気づかれているかどうかを持っている？<br>
A.わからない。撃たれたら気付くぐらいでは。でないとチートっぽい。<br>
Q.立体交差への対応は？<br>
A.マップが存在しているので、対応していると思う。<br>
Q.最適解を利用する？完全にポイント上だけの位置を考える？<br>
A.ポイントからの位置のずれは考えてなさそう。<br>
Q.扉を貫通する武器とかは？<br>
A.ほとんどのものが壊れないので、そういうものは考慮してなさそう。
</p>


<hr>

<h2>■どう発展させるか？</h2>

<p>
Halo2では<br>
　Killzoneでは、8方向に関する距離だが、Halo2では戦術的位置を埋め込んでいる。<br>
　Halo2はあるゾーンの中をAIが移動する。<br>
　エリアの概念が存在する。<br>
　隠れるためのオブジェクトに関して、ポイントをグループ化して、<br>
　ここは隠れるのに適さないと思ったら別のグループに移動。
</p>
<p>
クロムハウンズでは<br>
　ポイントなく３角形で考えている。<br>
　水とか砂地とかの属性を持たせて、最短時間経路を計算。<br>
　障害物の破壊に応じてメッシュデータを更新して、状況変化を実現。<br>
</p>
<p>
こんな感じで自分のゲームへ応用できるよ
</p>
<p>
Q&A<br>
Q.どうやってフラグの評価をしている？<br>
A.地形に応じて歩く速さが決まっているので、それで評価<br>
Q.ものが壊れたらパスの計算やり直し？<br>
A.してない。それより、パスがあっても実際に達成できない場合があり、「あまりに時間がかかっていたらパス検索しなおし」とか、「がけから落ちてしまったらパス検索しなおし」とかのタイミングで再計算している。<br>
Q.上り坂とか判定していない？<br>
A.足が遅いので、重要でないと判断し勾配による処理は入れていない。<br>
Q.仲間の位置関係を見ている？<br>
A.ゴール思考プランニングで処理している。目的自体を組み替えることで対応。
</p>

<hr>

<h2>■ディスカッションの前に…</h2>

<p>
ゲーム製作の長さが1-5年なので、基本設計をする機会は、この周期でしかない。<br>
機会が少ないので、かかわれる人が限られてしまう。
</p>
<p>
フロムでは、週１回ディスカッションしている（今は６０回ぐらい）<br>
企画さんと一緒に行っていて、新しいゲームデザインの創造を模索している。<br>
成果は社内メールやwebで情報公開している。<br>
モチベーションを高めるのにも役立つ（今回のセミナーは、それの全日本版をやりたいとおもって企画した）。
</p>

<hr>

<h2>■ディスカッション</h2>

<p>
KZのAIを自分のゲームに取り込ためには？<br>
どうやって取り組むか？<br>
　抽象化：そのままでは使えない。自分のCOMにさせたいことは？どんな追加情報が埋め込めそう？デザインの設計にAIを考える。如何にして単純化するか（認識モデルの設計の工夫が大事）？<br>
　制限の取り除き：<br>
　条件の違いから発展：<br>
　制作工程を考える：<br>
</p>

<p>
今まで、どんなものに世界表現が組み込まれていただろうか？<br>
　ピクミンがどうかねぇ？必ずしも統一的な動きじゃないよねぇ。<br>
　　パスファインでリングは工夫してるんかもね。行動は人間ほど知能が見えない。攻撃しろと言われたからしている感じ。<br>
　　　->じゃ、それを高度なものに置き換えられれるかなぁ<br>
　　ピクミンはAIを前提にしているからかマップが平坦。立体にするのは？<br>
　PS2上の制限が取っ払われるので想像つかない方向が在るのかなぁと思う。<br>
　　パワーがあがって、今までは、静的に作っていたと思うが、それを動かすのを楽しむゲームが作れるのでは？<br>
　　ポピュラスと同じじゃない？プレイヤーのなした結果を取っとくのが大変かな？<br>
　　それをとっとくと面白いかも知れない。<br>
　　それを世界中で共有して、攻略本が役に立たないゲームがあると面白そう。<br>
　世界表現が変化するのを学習してAIが進化するのは？<br>
　　「学習」は企画と技術者でイメージが違いそうだけど、皆さんの意見は？<br>
　　データ取っとくという話は、ゲームをデザインするゲームをするということになる。<br>
　　AIも発展できる余地を残しておかないと。<br>
　　世界表現を変えるのは、最初は動かすとゲーム性が変わるというイメージだった。AIが変わることは考えていなかった。足していくというよりは変化させていくという考えだったが…<br>
　　巨人のドシンがそんな感じかな？地形を変えると村人に感謝されるとか？<br>
　　　それは世界表現？スクリプトではない？<br>
　　ポピュラス、ブラックアンドホワイトとかもそんな感じ？<br>
　　自由度を増やしたときに制御できるかが難しくなる。<br>
　　　つまらなくなるのでは？AIも進化できないと意味ないよね。<br>
　　クロムハウンズも評価関数をかなり工夫してうまく行っていた。<br>
　　　ユーザーから見れば馬鹿でバグにしか見えなきときもあるよね。<br>
　　　動くものがあるときは、避けるよりもごり押しするほうが良かったりとか在るよね。<br>
　　　それを考えると、結局は無限大のバリエーションに陥るんじゃ<br>
　　　評価関数で対応できるんじゃない？<br>
　　　　つまらないことがあったときに評価関数を低くするとか。<br>
　　　シーンが変化すると評価関数で対応できないんじゃない？<br>
　　　メタにすれば対応できるのでは？<br>
　　　GAで対応は可能？GAは状況が決まっている中での対応しかできないのでは。<br>
　　　学習は、学習していくのが目に見えるのは楽しくなる。<br>
　　　GAの遺伝子を更新するときにランダムで入れて対応する手があるのでは。<br>
　　　メタの話をするときりがない。<br>
　　大戦略も同じような感じなのかなぁ<br>
　　　それほど変化するわけではないし、使っているかもね。<br>
　　　補給車とかあるし、少なくとも使えるのかなぁ
</p>
<p>
人間の心情を決定するのに世界構造が使えるかなぁ<br>
　日本的な発想で良さそう
</p>
<p>
うまいデータ構造が大事ですよね。<br>
　どんなデータを用意すればうまくいくか考えるのが面白いところ。
</p>
<p>
デバッグの前にモデル化が…そもそものデザインやプランニングが大事だよね。<br>
それを考えないで、変化させても無意味。<br>
KZもAIが人間サイズが前提で、それをうまく使っている。こういうデザイン的なうまいことをやっている。<br>
</p>
<p>
作るほうとしては自由度を高めると、バグの温床になるのでは？<br>
テストコードを書くと思うが、あれって気休めだよね。<br>
重要な値を調べると価値があるけれど、それは職人技。<br>
ある数理モデルがあって、論理的な検証法で適切なパラメータ範囲を検証する手があるのかなぁ？<br>
バグを論理的に抑えられるのであればそのような道があるかなぁ。<br>
無限の自由度があるけど、検証可能なモデルがあるのでは？<br>
気持ち的には、どこが適切かみえているはず。なんか押さえ切れるのでは？
</p>
<p>
いままでをまとめると：<br>
世界を変えていくことができそうだが、メタメタメタメタな話に落ちいりそう。<br>
ゲーム内の要求に適うかが問題。ゲーム性などの問題に絡んでくる
</p>

<p>
お題を変えて、他の発展の方向はない？<br>
</p>
<ul>
<li>チームプレイ（KZは断念）
<li>3Dの構造
<li>オブジェクトが壊れるを組み込んだら？
<li>車があるとか、相手が、人間以外になるという道は？<br>
　Halo2はうまくやってる。<br>
　KZは「人間」を前提にして、うまくやっている。
<li>KZは処理が軽い、HL2は物理演算をうまく使っている。<br>
　物理演算を入れると、世界の物理的な性質が入ってくる。
<li>マルチコアを考えると、KZは事前計算していたものを使ったが、それを更新するスレッドを立てるとかは？<br>
　じわじわと世界表現が変わっていく。
<li>手榴弾を投げるとかあったけど、トラップとかは？<br>
　トラップがあるかどうかで世界表現が人によって変わるとか。<br>
　動的なのはこじんまりとしたので可能ということかな？
<li>AIに関してもリアル嗜好があるよね。<br>
　それを意識しつつも日本的なものを作るのが道の１つかな。
</ul>
<p>
とにかく、今回のことを盛り込んで、他のゲームにいかせれば良いと思う
</p>

<hr>

<h2>■さいごに</h2>

<p>
ディスカッションは話が飛びまくりでついていけなかったので、今回のまとめは変なものになってしまいました。<br>
私は、A*をマスターしていないような未熟者ですが、なかなか楽しめました。
</p>


</div>
<BR CLEAR=ALL>
<BR CLEAR=ALL>
<BR CLEAR=ALL>
<center>
<hr>
<p><a href="../index.html">もどる</a></p>
<p><a href="mailto:imagire@gmail.com">imagire@gmail.com</a></p>
</center>

</body>
</html>
