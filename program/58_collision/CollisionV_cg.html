<HTML>
<HEAD>
<TITLE>CollisionV.cg</TITLE>
<meta name="GENERATOR" content="cpp2html 2.1 by Niisaka">
<meta http-equiv="Content-Type" content="text/html">
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF">
<PRE><FONT COLOR="#40F628">0001:</FONT> <FONT COLOR="#008000">//</FONT>
<FONT COLOR="#40F628">0002:</FONT> <FONT COLOR="#008000">// This program is to calculate the collision between bullet with ground.</FONT>
<FONT COLOR="#40F628">0003:</FONT> <FONT COLOR="#008000">// This calculation is the same as a shadow volume's one.</FONT>
<FONT COLOR="#40F628">0004:</FONT> <FONT COLOR="#008000">//</FONT>
<FONT COLOR="#40F628">0005:</FONT> 
<FONT COLOR="#40F628">0006:</FONT> <FONT COLOR="#008000">// ----------------------------------------------------------------------------</FONT>
<FONT COLOR="#40F628">0007:</FONT> <FONT COLOR="#008000">// Input datas</FONT>
<FONT COLOR="#40F628">0008:</FONT> <FONT COLOR="#008000">// ----------------------------------------------------------------------------</FONT>
<FONT COLOR="#40F628">0009:</FONT> <FONT COLOR="#0000FF">struct</FONT> appdata  {
<FONT COLOR="#40F628">0010:</FONT>     float4 position  : POSITION;
<FONT COLOR="#40F628">0011:</FONT>     float4 texcoord0 : TEXCOORD0;
<FONT COLOR="#40F628">0012:</FONT> };
<FONT COLOR="#40F628">0013:</FONT> <FONT COLOR="#008000">// ----------------------------------------------------------------------------</FONT>
<FONT COLOR="#40F628">0014:</FONT> <FONT COLOR="#008000">// Vertex shader program</FONT>
<FONT COLOR="#40F628">0015:</FONT> <FONT COLOR="#008000">// ----------------------------------------------------------------------------</FONT>
<FONT COLOR="#40F628">0016:</FONT> vf20 main(appdata I
<FONT COLOR="#40F628">0017:</FONT>         , uniform float4x4 viewproj_matrix
<FONT COLOR="#40F628">0018:</FONT>         , uniform float4 trans
<FONT COLOR="#40F628">0019:</FONT>         , uniform float4 velocity
<FONT COLOR="#40F628">0020:</FONT>         , uniform float4 color
<FONT COLOR="#40F628">0021:</FONT> ) {
<FONT COLOR="#40F628">0022:</FONT>     vf20 O;
<FONT COLOR="#40F628">0023:</FONT>     
<FONT COLOR="#40F628">0024:</FONT>     <FONT COLOR="#008000">// Coordinate transformation</FONT>
<FONT COLOR="#40F628">0025:</FONT>     float4 v = (0&lt;=dot(I.position, velocity))
<FONT COLOR="#40F628">0026:</FONT>                     ? I.position
<FONT COLOR="#40F628">0027:</FONT>                     : (I.position-velocity);
<FONT COLOR="#40F628">0028:</FONT>     v=v+trans;
<FONT COLOR="#40F628">0029:</FONT>     O.HPOS = mul(viewproj_matrix, v);
<FONT COLOR="#40F628">0030:</FONT>     
<FONT COLOR="#40F628">0031:</FONT>     <FONT COLOR="#008000">// I copy a constant to the vertex color</FONT>
<FONT COLOR="#40F628">0032:</FONT>     O.COL0   = color;
<FONT COLOR="#40F628">0033:</FONT> 
<FONT COLOR="#40F628">0034:</FONT>     <FONT COLOR="#0000FF">return</FONT> O;
<FONT COLOR="#40F628">0035:</FONT> } 
<FONT COLOR="#40F628">0036:</FONT> 
<FONT COLOR="#40F628">0037:</FONT> 
<FONT COLOR="#40F628">0038:</FONT> </PRE>
</BODY>
</HTML>
